<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title th:text="${post.title}">상세</title>
</head>
<body>
  <h1 th:text="${post.title}">제목</h1>

  <p>
    <strong>작성자</strong>:
    <span th:text="${post.user != null ? post.user.username : '알수없음'}">작성자</span>
    <span th:if="${post.createdAt}" style="margin-left:8px;">
      | <strong>작성일</strong>:
      <span th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd HH:mm')}">2025-01-01 12:00</span>
    </span>
  </p>

  <div style="white-space:pre-wrap;" th:text="${post.content}">내용</div>

  <hr/>
  <a th:href="@{/posts}">목록으로</a>
  <a th:if="${canEdit}" th:href="@{|/posts/${post.id}/edit|}">수정</a>

  <!-- 삭제 버튼: 소유자/관리자에게만 노출 -->
  <form th:if="${canEdit}" th:action="@{|/posts/${post.id}/delete|}" method="post" style="display:inline">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
    <button type="submit" onclick="return confirm('삭제하시겠습니까?')">삭제</button>
  </form>

  <!-- 권한 오류 플래시 메시지 -->
  <script th:if="${error}" th:inline="javascript">
    /*<![CDATA[*/
    const msg = /*[[${#strings.escapeJavaScript(error)}]]*/ "";
    alert(msg);
  /*]]>*/
  </script>
</body>
</html>
