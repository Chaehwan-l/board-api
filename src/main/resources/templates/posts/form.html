<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>글쓰기 / 수정</title>
</head>
<body>
  <h1 th:text="${post.id != null} ? '수정' : '새 글쓰기'">폼</h1>

  <form th:object="${post}"
        th:action="${post.id != null} ? @{/posts/{id}(id=${post.id})} : @{/posts}"
        method="post">

    <!-- CSRF -->
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

    <!-- 메서드 오버라이드 -->
    <input type="hidden" name="_method"
           th:value="${post.id != null} ? 'PUT' : 'POST'"/>

    <div th:if="${#fields.hasErrors('*')}">
      <ul>
        <li th:each="err : ${#fields.errors('*')}" th:text="${err}"></li>
      </ul>
    </div>

    <div>
      <label>제목</label>
      <input type="text" th:field="*{title}"/>
      <span th:if="${#fields.hasErrors('title')}" th:errors="*{title}"></span>
    </div>

    <div>
      <label>내용</label>
      <textarea th:field="*{content}"></textarea>
      <span th:if="${#fields.hasErrors('content')}" th:errors="*{content}"></span>
    </div>

    <button type="submit">저장</button>
    <a th:href="@{/posts}">취소</a>
  </form>
</body>
</html>
